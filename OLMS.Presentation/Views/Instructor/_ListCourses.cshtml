@{
    ViewData["Title"] = "Course List";
}

<h2>Course List</h2>

<!-- Search Input -->
<input type="number" id="searchInput" placeholder="Enter course ID..." />
<button onclick="searchCourses()">Search</button>

<!-- Display Courses -->
<div id="coursesContainer"></div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        loadCourses();
    });

    function loadCourses() {
        fetch('/ins/courses')
            .then(response => response.json())
            .then(data => {
                console.log("JSON Response:", data);
                let container = document.getElementById("coursesContainer");
                container.innerHTML = ""; // Clear previous content
                console.log(data.courses)

				if (!data.courses || data.courses.length == 0) {
					container.innerHTML = "<p>No courses available.</p>";
					return;
				}

                data.courses.forEach(course => {
                    let courseItem = document.createElement("div");
                    courseItem.classList.add("course-item");

                    courseItem.innerHTML = `
                        <strong>Code:</strong> ${course[0]} <br>
                        <strong>Title:</strong> ${course.title} <br>
                        <strong>Description:</strong> ${course.description} <br>
                        <a class="btn btn-primary" href="/Home/JoinCourse?code=${course.code}">Join Course</a>
                        <hr>
                    `;
                    container.appendChild(courseItem);
                });
            })
            .catch(error => console.error("Error loading courses:", error));
    }

    function searchCourses() {
        let input = document.getElementById("searchInput").value.trim();
        let courses = document.querySelectorAll(".courseTable");

        courses.forEach(course => {
            let courseId = course.getAttribute("data-course-id");
            if (courseId === input || input === "") {
                course.style.display = "";
            } else {
                course.style.display = "none";
            }
        });
    }
</script>

<!-- CSS for Styling -->
<style>
    .courseTable {
        margin-bottom: 20px;
        border: 1px solid black;
        padding: 10px;
        width: fit-content;
    }
    .courseTable th {
        text-align: left;
        padding-right: 10px;
    }
</style>

